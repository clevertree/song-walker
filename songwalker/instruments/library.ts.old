import {InstrumentBank, InstrumentLoader} from "@songwalker/types";
import OscillatorInstrument from "@songwalker/instruments/OscillatorInstrument";
import AudioBufferInstrument from "@songwalker/instruments/AudioBufferInstrument";
import PolyphonyInstrument from "@songwalker/instruments/PolyphonyInstrument";


const instrumentList: { [instrumentName: string]: any } = {
    'Oscillator': OscillatorInstrument,
    'AudioBuffer': AudioBufferInstrument,
    'Polyphony': PolyphonyInstrument
}

const InstrumentLibrary: InstrumentBank = {
    getInstrumentLoader(instrumentPath: string): InstrumentLoader {
        const instrumentLoader = instrumentList[instrumentPath] as InstrumentLoader
        if (!instrumentLoader)
            throw new Error("Instrument not found: " + instrumentPath);
        return instrumentLoader;
    }

}

export default InstrumentLibrary;

export function registerInstrument(instrumentName: string, instrumentLoader: InstrumentLoader) {
    instrumentList[instrumentName] = instrumentLoader;
}
